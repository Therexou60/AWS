# ğŸš€ SÃ©curisation d'un Application Load Balancer derriÃ¨re Amazon CloudFront



## âœ… Solution 1 : SÃ©curisation du niveau rÃ©seau (L4) avec Security Groups et IP Restriction

### ğŸ—ï¸ Ã‰tapes dÃ©taillÃ©es

1. **Identifier les adresses IP de CloudFront**
   - RÃ©cupÃ©rer les plages IP utilisÃ©es par CloudFront via AWS (disponible sur [AWS IP Ranges](https://docs.aws.amazon.com/general/latest/gr/aws-ip-ranges.html)).

2. **Modifier les Security Groups de l'ALB**
   - Aller dans AWS EC2 â†’ Security Groups.
   - Trouver le Security Group associÃ© Ã  l'ALB.
   - **Supprimer toute rÃ¨gle autorisant le trafic HTTP/HTTPS ouvert Ã  tous (`0.0.0.0/0`)**.
   - Ajouter une rÃ¨gle autorisant uniquement le trafic HTTP/HTTPS venant des adresses IP CloudFront.

3. **VÃ©rifier la restriction**
   - AccÃ©der Ã  l'ALB directement via son DNS â†’ VÃ©rifier qu'il est bloquÃ©.
   - AccÃ©der via CloudFront â†’ VÃ©rifier que l'accÃ¨s fonctionne.

---

## âœ… Solution 2 : SÃ©curisation du niveau applicatif (L7) avec CloudFront Headers et WAF

### ğŸ—ï¸ Ã‰tapes dÃ©taillÃ©es

1. **Configurer CloudFront pour envoyer un Header personnalisÃ©**
   - Aller dans AWS CloudFront.
   - SÃ©lectionner la distribution concernÃ©e.
   - Dans "Behaviors", modifier le comportement associÃ© Ã  l'ALB.
   - Ajouter un header personnalisÃ© (ex: `X-CloudFront-Origin: allowed`).

2. **CrÃ©er une rÃ¨gle WAF pour bloquer l'accÃ¨s direct Ã  l'ALB**
   - Aller dans AWS WAF.
   - CrÃ©er un nouveau Web ACL et lâ€™attacher Ã  lâ€™ALB.
   - Ajouter une rÃ¨gle personnalisÃ©e :
     - **Autoriser uniquement les requÃªtes contenant `X-CloudFront-Origin: allowed`**.
     - **Bloquer toute autre requÃªte**.

3. **Tester la protection**
   - AccÃ©der Ã  l'ALB directement via son DNS â†’ VÃ©rifier qu'il est bloquÃ©.
   - AccÃ©der via CloudFront â†’ VÃ©rifier que l'accÃ¨s fonctionne.

---

## ğŸ”„ Alternatives et solutions supplÃ©mentaires

1. **Utiliser AWS Lambda@Edge**
   - Ajouter une fonction Lambda@Edge pour filtrer les requÃªtes basÃ©es sur l'`User-Agent` et d'autres caractÃ©ristiques spÃ©cifiques.

2. **Mettre en place AWS Shield Advanced**
   - Protection supplÃ©mentaire contre les attaques DDoS ciblant CloudFront et ALB.

3. **Activer AWS GuardDuty**
   - DÃ©tection avancÃ©e des tentatives d'accÃ¨s non autorisÃ©es.

4. **Configurer AWS CloudTrail Logs**
   - Surveillance des accÃ¨s directs et ajustement des rÃ¨gles si nÃ©cessaire.


