# ğŸš€ Challenge "Who AM I" : Gestion des accÃ¨s avec AWS

## ğŸ“Œ Contexte
En tant qu'administrateur AWS, votre objectif est de garantir une gestion des identitÃ©s et des accÃ¨s (IAM) sÃ©curisÃ©e, tout en implÃ©mentant des politiques d'accÃ¨s adaptÃ©es. Ce challenge consiste Ã  :
- Configurer des utilisateurs et groupes IAM.
- Appliquer des politiques d'accÃ¨s granulaires.
- Activer des mÃ©canismes d'authentification sÃ©curisÃ©s.

### ğŸ”§ Services AWS potentiellement utilisÃ©s
- **AWS IAM (Identity and Access Management)**
- **AWS S3 (Simple Storage Service)**
- **CloudWatch Logs**
- **AWS Organizations**
- **AWS Cognito** (optionnel)

---

## âœ… Solution 1 : Gestion des accÃ¨s via IAM

### ğŸ—ï¸ Ã‰tapes dÃ©taillÃ©es

1. **CrÃ©er des utilisateurs IAM avec permissions minimales**
   - AccÃ©der Ã  la console AWS â†’ IAM â†’ "Users" â†’ "Add users".
   - Configurer :
     - Nom d'utilisateur.
     - AccÃ¨s programmatique (clÃ© d'accÃ¨s) ou accÃ¨s Ã  la console AWS.
     - **Ne pas attribuer d'accÃ¨s administrateur global**.
   - Ajouter les utilisateurs Ã  un groupe IAM.

2. **CrÃ©er des groupes IAM avec des politiques adaptÃ©es**
   - Aller dans IAM â†’ "Groups" â†’ "Create Group".
   - Ajouter des utilisateurs IAM au groupe.
   - Associer une politique spÃ©cifique :
     - **PowerUserAccess** : Si besoin d'accÃ¨s sans gestion IAM.
     - **S3ReadOnlyAccess** : Pour lecture seule sur S3.
     - **Politiques personnalisÃ©es** : CrÃ©er une politique JSON pour limiter l'accÃ¨s (exemple ci-dessous).

     ```json
     {
       "Version": "2012-10-17",
       "Statement": [
         {
           "Effect": "Allow",
           "Action": "s3:GetObject",
           "Resource": "arn:aws:s3:::example-bucket/*"
         }
       ]
     }
     ```

3. **Configurer l'authentification Multi-Factor (MFA)**
   - Aller dans IAM â†’ "Users" â†’ SÃ©lectionner un utilisateur â†’ "Security credentials".
   - Activer MFA (virtual MFA device, U2F, etc.).
   - Fournir les instructions pour configurer une application MFA (Google Authenticator, Authy, etc.).

4. **Activer les logs IAM dans CloudTrail**
   - AccÃ©der Ã  AWS CloudTrail.
   - CrÃ©er un trail pour capturer toutes les activitÃ©s IAM.
   - Envoyer les logs vers un bucket S3 pour analyse.

5. **Limiter les accÃ¨s avec Conditions IAM**
   - Ajouter des conditions basÃ©es sur :
     - **SourceIP** : Restreindre les accÃ¨s Ã  une plage IP spÃ©cifique.
     - **Heure** : Autoriser uniquement certains crÃ©neaux horaires.

     Exemple :
     ```json
     {
       "Effect": "Deny",
       "Action": "*",
       "Resource": "*",
       "Condition": {
         "NotIpAddress": {
           "aws:SourceIp": "192.168.0.0/24"
         }
       }
     }
     ```

---

## âœ… Solution 2 : Gestion des identitÃ©s avec AWS Cognito (Optionnel)

### ğŸ—ï¸ Ã‰tapes dÃ©taillÃ©es

1. **CrÃ©er un User Pool dans AWS Cognito**
   - AccÃ©der Ã  la console Cognito â†’ "Manage User Pools" â†’ "Create a user pool".
   - Configurer les paramÃ¨tres d'utilisateur (e-mail, numÃ©ro de tÃ©lÃ©phone, etc.).
   - Activer MFA pour sÃ©curiser les connexions utilisateur.

2. **Configurer une application cliente**
   - Ajouter une application cliente dans le User Pool.
   - Configurer les permissions pour accÃ©der aux ressources AWS.

3. **Connecter Cognito Ã  des groupes IAM**
   - CrÃ©er des rÃ´les IAM pour les groupes Cognito.
   - Associer des politiques pour limiter l'accÃ¨s.

4. **IntÃ©grer Cognito avec votre application**
   - Utiliser l'API AWS Cognito pour l'authentification et l'autorisation.
   - GÃ©rer les tokens JWT pour valider les sessions utilisateur.

---

## ğŸ”„ Alternatives et solutions supplÃ©mentaires

1. **Utiliser AWS Organizations pour gÃ©rer les comptes multiples**
   - Centraliser la gestion des politiques IAM via une stratÃ©gie d'organisation.

2. **Mettre en place des alarmes CloudWatch pour surveiller les activitÃ©s suspectes**
   - Exemple : DÃ©tection des tentatives de connexion Ã©chouÃ©es rÃ©pÃ©tÃ©es.

3. **Activer AWS Config Rules**
   - VÃ©rifier que toutes les ressources respectent les meilleures pratiques IAM (MFA activÃ©, politique restrictive, etc.).

4. **Automatiser la gestion avec AWS CLI ou AWS SDK**
   - CrÃ©er des scripts pour provisionner rapidement les utilisateurs et groupes IAM.

# WHO AM I - Identification de l'utilisateur IAM

## ğŸš€ Solution 1 : Identification via AWS CLI

### ğŸ—ï¸ Ã‰tapes Ã  suivre

1. **RÃ©cupÃ©rer la clÃ© d'accÃ¨s depuis S3**
   - Aller dans la console AWS â†’ S3
   - Localiser l'objet contenant les credentials
   - TÃ©lÃ©charger et ouvrir le fichier
   
2. **Configurer temporairement AWS CLI avec la clÃ© trouvÃ©e**
   ```sh
   aws configure set aws_access_key_id <ACCESS_KEY>
   aws configure set aws_secret_access_key <SECRET_KEY>
   ```

3. **Identifier l'utilisateur IAM et l'account AWS**
   ```sh
   aws sts get-caller-identity
   ```
   - Cette commande retourne l'ARN de l'utilisateur, son ID et le numÃ©ro du compte AWS
   
4. **Lister les permissions associÃ©es**
   ```sh
   aws iam list-attached-user-policies --user-name <USERNAME>
   ```
   - Permet dâ€™identifier les permissions de cet utilisateur

5. **DÃ©sactiver immÃ©diatement la clÃ© compromise**
   ```sh
   aws iam update-access-key --access-key-id <ACCESS_KEY> --status Inactive --user-name <USERNAME>
   ```
   
6. **Supprimer la clÃ© aprÃ¨s vÃ©rification**
   ```sh
   aws iam delete-access-key --access-key-id <ACCESS_KEY> --user-name <USERNAME>
   ```
   
---

## ğŸ› ï¸ Solution 2 : VÃ©rification via la Console AWS

### ğŸ—ï¸ Ã‰tapes Ã  suivre

1. **AccÃ©der Ã  la console AWS â†’ IAM**
2. **Aller dans la section "Users" et rechercher lâ€™Access Key**
3. **VÃ©rifier les logs CloudTrail pour voir lâ€™activitÃ© de cette clÃ©**
4. **DÃ©sactiver/Supprimer la clÃ© compromise**
5. **Notifier les Ã©quipes de sÃ©curitÃ© pour analyser lâ€™origine de la fuite**
# WHO AM I - Identification d'un Utilisateur IAM

## ğŸš€ Solution 1 : Utilisation de la Console AWS

### ğŸ—ï¸ Ã‰tapes Ã  suivre

1. **AccÃ©der au bucket S3 contenant les clÃ©s**
   - Aller dans la console AWS â†’ S3
   - Trouver le bucket mentionnÃ© dans lâ€™Ã©noncÃ©
   - Rechercher lâ€™objet contenant lâ€™Access Key et le Secret Key

2. **Identifier lâ€™utilisateur IAM Ã  partir de lâ€™Access Key**
   - Aller dans la console AWS â†’ IAM
   - Dans lâ€™onglet "Access Management", sÃ©lectionner "Users"
   - Rechercher dans la liste des utilisateurs si lâ€™Access Key correspond Ã  un utilisateur existant

3. **VÃ©rifier les permissions associÃ©es**
   - Examiner les permissions de lâ€™utilisateur trouvÃ©
   - Identifier si cet utilisateur a des droits excessifs

4. **RÃ©voquer et sÃ©curiser lâ€™accÃ¨s si nÃ©cessaire**
   - Si lâ€™Access Key a Ã©tÃ© exposÃ©e, la dÃ©sactiver immÃ©diatement
   - GÃ©nÃ©rer une nouvelle paire de clÃ©s et mettre Ã  jour les services utilisant cette clÃ©
   - Informer les administrateurs pour prendre des mesures de sÃ©curitÃ©

---

## ğŸ› ï¸ Solution 2 : Automatisation avec AWS Config et IAM Access Analyzer

### ğŸ—ï¸ Ã‰tapes Ã  suivre

1. **Activer AWS Config pour suivre les changements IAM**
   - Aller dans la console AWS â†’ AWS Config
   - Activer AWS Config et ajouter des rÃ¨gles pour suivre les changements IAM

2. **Utiliser IAM Access Analyzer pour identifier les accÃ¨s non sÃ©curisÃ©s**
   - Aller dans la console AWS â†’ IAM
   - Ouvrir "Access Analyzer"
   - VÃ©rifier si lâ€™utilisateur ayant les clÃ©s exposÃ©es a des permissions trop larges

3. **RemÃ©dier aux failles de sÃ©curitÃ©**
   - RÃ©voquer les accÃ¨s inappropriÃ©s
   - Appliquer des politiques de permissions plus restrictives


## ğŸ—ï¸ Solutions Alternatives si les approches ci-dessus ne fonctionnent pas

1. **CloudTrail pour retracer lâ€™activitÃ© de la clÃ©**
   - Si la clÃ© a Ã©tÃ© utilisÃ©e, CloudTrail permettra de voir quelles actions ont Ã©tÃ© effectuÃ©es
   
2. **AWS Config pour vÃ©rifier la conformitÃ© des clÃ©s IAM**
   - AWS Config peut signaler les clÃ©s IAM laissÃ©es actives trop longtemps
   
3. **Secrets Manager pour gÃ©rer les credentials sensibles**
   - Pour Ã©viter ce problÃ¨me Ã  lâ€™avenir, stocker les credentials dans AWS Secrets Manager

4. **CrÃ©er un SCP (Service Control Policy) pour restreindre lâ€™utilisation des clÃ©s IAM**
   - Permet dâ€™Ã©viter que des clÃ©s IAM puissent Ãªtre utilisÃ©es en dehors dâ€™un environnement AWS spÃ©cifique

5. **Utilisation de CodeWhisperer pour dÃ©tecter les fuites dans le code**
   - IntÃ©grer CodeWhisperer pour dÃ©tecter automatiquement les fuites de credentials dans les repositories
